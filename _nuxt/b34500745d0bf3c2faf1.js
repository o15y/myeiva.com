(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{267:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(100);var o=n(119);function c(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},329:function(e,t,n){"use strict";n.r(t);n(19),n(20),n(13),n(40);var r=n(267),o=(n(34),n(7)),c=n(21),l=n(118),m=n(22),d=n(23),f=n(9),v=n(8),h=n(55);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var E=function(e,t,n,desc){var r,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(v.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(c=(o<3?r(c):o>3?r(t,n,c):r(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c},w=function(e){Object(m.a)(E,e);var t,n,d,f,v,h=y(E);function E(){var e;return Object(c.a)(this,E),(e=h.apply(this,arguments)).newEmail="",e.loading=!1,e.loadingAdd=!1,e.loadingSave=!1,e.primaryEmailId=0,e.notificationEmails="ACCOUNT",e.emails={data:[]},e}return Object(l.a)(E,[{key:"created",value:(v=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.get());case 1:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"get",value:(f=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n,data,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$axios.get("/users/".concat(this.$route.params.username,"/emails?first=10").concat(this.emails.data.length?"&after=".concat(this.emails.data[this.emails.data.length-1].id):""));case 4:n=e.sent,data=n.data,(t=this.emails.data).push.apply(t,Object(r.a)(data.data||[])),this.emails.hasMore=data.hasMore,this.emails=data,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:return e.prev=13,e.next=16,this.$axios.get("/users/".concat(this.$route.params.username));case 16:o=e.sent,this.notificationEmails=o.data.notificationEmails,this.primaryEmailId=o.data.primaryEmail,e.next=23;break;case 21:e.prev=21,e.t1=e.catch(13);case 23:this.loading=!1;case 24:case"end":return e.stop()}}),e,this,[[1,11],[13,21]])}))),function(){return f.apply(this,arguments)})},{key:"add",value:(d=Object(o.a)(regeneratorRuntime.mark((function e(){var t,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingAdd=!0,e.prev=1,e.next=4,this.$axios.put("/users/".concat(this.$route.params.username,"/emails"),{email:this.newEmail});case 4:t=e.sent,data=t.data,this.emails.data.push(data.added),this.newEmail="",e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:this.loadingAdd=!1;case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(){return d.apply(this,arguments)})},{key:"save",value:(n=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingSave=!0,e.prev=1,e.next=4,this.$axios.patch("/users/".concat(this.$route.params.username),{primaryEmail:this.primaryEmailId,notificationEmails:this.notificationEmails});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:this.loadingSave=!1;case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(){return n.apply(this,arguments)})},{key:"deleteEmail",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$buefy.dialog.confirm({title:"Deleting email",message:"Are you sure you want to delete your email <strong>".concat(n,"</strong>? This action is not reversible, and you'll have to verify this email again if you change your mind."),confirmText:"Yes, delete email",cancelText:"No, don't delete",type:"is-danger",hasIcon:!0,trapFocus:!0,onConfirm:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.loading=!0,e.prev=1,e.next=4,r.$axios.delete("/users/".concat(r.$route.params.username,"/emails/").concat(t));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return r.emails={data:[]},e.abrupt("return",r.get());case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"verifiedEmails",get:function(){try{if(this.emails&&this.emails.data)return this.emails.data.filter((function(e){return e.isVerified}))}catch(e){}return[]}}]),E}(h.b),x=w=E([Object(h.a)({middleware:"authenticated",layout:"users"})],w),_=n(14),component=Object(_.a)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",{staticClass:"is-size-4"},[e._v("Emails")]),e._v(" "),n("b-table",{attrs:{loading:e.loading,data:e.emails.data,"default-sort-direction":"asc","sort-icon":"arrow-up","sort-icon-size":"is-small"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("b-table-column",{attrs:{sortable:"",field:"email",label:"Email"}},[e._v("\n        "+e._s(t.row.email)+"\n        "),t.row.isVerified?n("b-tooltip",{attrs:{label:"Verified"}},[n("b-icon",{attrs:{icon:"check-circle",type:"is-success"}})],1):n("b-tooltip",{attrs:{label:"Unverified"}},[n("b-icon",{attrs:{icon:"alert",type:"is-warning"}})],1)],1),e._v(" "),n("b-table-column",{attrs:{sortable:"",field:"createdAt",label:"Added"}},[e._v("\n        "+e._s(new Date(t.row.createdAt).toLocaleDateString())+"\n      ")]),e._v(" "),n("b-table-column",{staticClass:"has-text-right"},[n("b-tooltip",{attrs:{label:"Delete"}},[n("b-button",{attrs:{type:"is-danger","icon-right":"delete"},on:{click:function(n){return e.deleteEmail(t.row.id,t.row.email)}}})],1)],1)]}}])}),e._v(" "),n("div",{staticClass:"has-text-centered"},[e.emails.hasMore?n("b-button",{attrs:{"icon-right":"arrow-down",loading:e.loading},on:{click:e.get}},[e._v("\n      Load more emails\n    ")]):e._e()],1),e._v(" "),n("h2",{staticClass:"is-size-5",staticStyle:{"margin-top":"1rem"}},[e._v("Add email")]),e._v(" "),n("form",{staticStyle:{margin:"0.5rem 0 1.5rem"},on:{submit:function(t){return t.preventDefault(),e.add(t)}}},[n("b-field",{attrs:{label:"Email"}},[n("b-input",{attrs:{type:"email",required:""},model:{value:e.newEmail,callback:function(t){e.newEmail=t},expression:"newEmail"}})],1),e._v(" "),n("b-button",{attrs:{type:"is-primary","native-type":"submit",loading:e.loadingAdd}},[e._v("\n      Add email\n    ")])],1),e._v(" "),n("h2",{staticClass:"is-size-5"},[e._v("Email preferences")]),e._v(" "),n("form",{on:{submit:function(t){return t.preventDefault(),e.save(t)}}},[n("b-field",{attrs:{label:"Primary email",message:"We'll send you emails only on your primary email"}},[n("b-select",{attrs:{expanded:""},model:{value:e.primaryEmailId,callback:function(t){e.primaryEmailId=t},expression:"primaryEmailId"}},e._l(e.verifiedEmails,(function(t,i){return n("option",{key:"e"+t.id+i,domProps:{value:t.id}},[e._v("\n          "+e._s(t.email)+"\n        ")])})),0)],1),e._v(" "),n("b-field",{attrs:{label:"Notification emails"}},[n("div",[n("b-radio",{attrs:{name:"radioNotificationEmails","native-value":"ACCOUNT"},model:{value:e.notificationEmails,callback:function(t){e.notificationEmails=t},expression:"notificationEmails"}},[e._v("\n          Account and security\n        ")]),e._v(" "),n("b-radio",{attrs:{name:"radioNotificationEmails","native-value":"UPDATES"},model:{value:e.notificationEmails,callback:function(t){e.notificationEmails=t},expression:"notificationEmails"}},[e._v("\n          App updates\n        ")]),e._v(" "),n("b-radio",{attrs:{name:"radioNotificationEmails","native-value":"PROMOTIONS"},model:{value:e.notificationEmails,callback:function(t){e.notificationEmails=t},expression:"notificationEmails"}},[e._v("\n          Promotions\n        ")])],1)]),e._v(" "),n("b-button",{attrs:{type:"is-primary","native-type":"submit",loading:e.loadingSave}},[e._v("\n      Update settings\n    ")])],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);